"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[200],{"9200":function(e,r,t){t.r(r),t.d(r,{"default":function(){return OrdersPage}});var n=t(8646),c=t(6673),o=t(9866),a=t(7378),i=t(4657),s=t(6244),u=t(8785),l=t(6287),p=t(4088),f=t(6106);function OrdersPage(){var e=(0,a.useState)([]),r=(0,o.A)(e,2),t=r[0],d=r[1],A=(0,a.useState)(!1),_=(0,o.A)(A,2),v=_[0],h=_[1],y=(0,a.useState)(void 0),m=(0,o.A)(y,2),S=m[0],g=m[1],w=(0,a.useState)(null),O=(0,o.A)(w,2),x=O[0],C=O[1];function _loadCurrentStore(){return(_loadCurrentStore=(0,c.A)((0,n.A)().m(function _callee(){var e,r,t;return(0,n.A)().w(function(n){for(;;)switch(n.p=n.n){case 0:if(n.p=0,e=(0,s.JF)("current_store_id"),r=e?Number(e):NaN,Number.isNaN(r)||!(r>0)){n.n=2;break}return n.n=1,(0,p.KA)(r);case 1:t=n.v,C(t);case 2:n.n=4;break;case 3:n.p=3,n.v;case 4:return n.a(2)}},_callee,null,[[0,3]])}))).apply(this,arguments)}function _fetchOrders(){return(_fetchOrders=(0,c.A)((0,n.A)().m(function _callee2(){var e,r,t,c,o,a;return(0,n.A)().w(function(n){for(;;)switch(n.p=n.n){case 0:return h(!0),n.p=1,e=null==x?void 0:x.id,r={"page":1,"limit":20},"number"==typeof S&&(r.status=S),e&&Number.isFinite(e)&&e>0&&(r.store_id=e),n.n=2,(0,l.MV)(r);case 2:t=n.v,c=t,o=Array.isArray(null==c?void 0:c.data)?c.data:Array.isArray(null==c?void 0:c.items)?c.items:Array.isArray(c)?c:[],d(o),n.n=4;break;case 3:n.p=3,a=n.v,console.error("load orders failed",a);case 4:return n.p=4,h(!1),n.f(4);case 5:return n.a(2)}},_callee2,null,[[1,3,4,5]])}))).apply(this,arguments)}function changeStatus(e){g(e)}return(0,a.useEffect)(function(){!function loadCurrentStore(){return _loadCurrentStore.apply(this,arguments)}()},[]),(0,a.useEffect)(function(){!function fetchOrders(){return _fetchOrders.apply(this,arguments)}()},[S,null==x?void 0:x.id]),(0,f.jsxs)(i.Ss,{"data-testid":"page-orders","style":{"padding":12},"children":[x&&(0,f.jsx)(i.Ss,{"style":{"marginBottom":8,"padding":"6px 10px","borderWidth":1,"borderStyle":"solid","borderColor":"#07c160","borderRadius":16,"display":"inline-block","backgroundColor":"#f6ffed"},"children":(0,f.jsxs)(i.EY,{"style":{"color":"#389e0d"},"children":["当前门店：",x.name]})}),(0,f.jsxs)(i.Ss,{"style":{"marginBottom":12,"display":"flex","flexDirection":"row"},"children":[(0,f.jsx)(i.$n,{"size":"mini","onClick":function onClick(){return changeStatus(void 0)},"children":"全部"}),(0,f.jsx)(i.$n,{"size":"mini","onClick":function onClick(){return changeStatus(1)},"style":{"marginLeft":8},"children":"待支付"}),(0,f.jsx)(i.$n,{"size":"mini","onClick":function onClick(){return changeStatus(2)},"style":{"marginLeft":8},"children":"已支付"}),(0,f.jsx)(i.$n,{"size":"mini","onClick":function onClick(){return changeStatus(4)},"style":{"marginLeft":8},"children":"已完成"})]}),v&&(0,f.jsx)(i.EY,{"children":"加载中..."}),!v&&!t.length&&(0,f.jsx)(i.EY,{"children":"暂无订单"}),t.map(function(e){return(0,f.jsxs)(i.Ss,{"style":{"marginBottom":12,"borderBottomWidth":1,"borderStyle":"solid","borderColor":"#eee","paddingBottom":8},"children":[(0,f.jsxs)(i.EY,{"children":["订单号: ",e.order_no]}),(0,f.jsxs)(i.EY,{"children":[" 金额: ",e.pay_amount]}),(0,f.jsxs)(i.EY,{"children":[" 状态: ",e.status]}),(0,f.jsx)(i.$n,{"size":"mini","style":{"marginTop":4},"onClick":function onClick(){return function goDetail(e){var r=null==x?void 0:x.id,t=r&&r>0?"/pages/order-detail/index?id=".concat(e,"&store_id=").concat(r):"/pages/order-detail/index?id=".concat(e);u.Ay.navigateTo({"url":t})}(e.id)},"children":"查看详情"})]},e.id)})]})}},"6287":function(e,r,t){t.d(r,{"Ad":function(){return confirmReceive},"MV":function(){return listOrders},"N4":function(){return cancelOrder},"SK":function(){return getAvailableCouponsForOrder},"Tg":function(){return payOrder},"X9":function(){return createOrderFromCart},"r$":function(){return getOrder}});var n=t(8646),c=t(6673),o=t(7356);function createOrderFromCart(e){return _createOrderFromCart.apply(this,arguments)}function _createOrderFromCart(){return(_createOrderFromCart=(0,c.A)((0,n.A)().m(function _callee(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.post("/api/v1/orders/from-cart",e);case 1:return r=t.v,t.a(2,(0,o.Bm)(r))}},_callee)}))).apply(this,arguments)}function listOrders(){return _listOrders.apply(this,arguments)}function _listOrders(){return _listOrders=(0,c.A)((0,n.A)().m(function _callee2(){var e,r,t=arguments;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return e=t.length>0&&void 0!==t[0]?t[0]:{},n.n=1,o.Ay.get("/api/v1/orders",{"params":e});case 1:return r=n.v,n.a(2,(0,o.Bm)(r))}},_callee2)})),_listOrders.apply(this,arguments)}function getOrder(e){return _getOrder.apply(this,arguments)}function _getOrder(){return(_getOrder=(0,c.A)((0,n.A)().m(function _callee3(e){var r,t;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o.Ay.get("/api/v1/orders/".concat(e));case 1:return r=n.v,t=(0,o.Bm)(r),n.a(2,{"order":null==t?void 0:t.order,"items":Array.isArray(null==t?void 0:t.items)?t.items:[]})}},_callee3)}))).apply(this,arguments)}function cancelOrder(e,r){return _cancelOrder.apply(this,arguments)}function _cancelOrder(){return(_cancelOrder=(0,c.A)((0,n.A)().m(function _callee4(e,r){var t;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o.Ay.post("/api/v1/orders/".concat(e,"/cancel"),{"reason":r});case 1:t=n.v,(0,o.Bm)(t);case 2:return n.a(2)}},_callee4)}))).apply(this,arguments)}function payOrder(e){return _payOrder.apply(this,arguments)}function _payOrder(){return(_payOrder=(0,c.A)((0,n.A)().m(function _callee5(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.post("/api/v1/orders/".concat(e,"/pay"));case 1:r=t.v,(0,o.Bm)(r);case 2:return t.a(2)}},_callee5)}))).apply(this,arguments)}function confirmReceive(e){return _confirmReceive.apply(this,arguments)}function _confirmReceive(){return(_confirmReceive=(0,c.A)((0,n.A)().m(function _callee6(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.post("/api/v1/orders/".concat(e,"/receive"));case 1:r=t.v,(0,o.Bm)(r);case 2:return t.a(2)}},_callee6)}))).apply(this,arguments)}function getAvailableCouponsForOrder(e){return _getAvailableCouponsForOrder.apply(this,arguments)}function _getAvailableCouponsForOrder(){return(_getAvailableCouponsForOrder=(0,c.A)((0,n.A)().m(function _callee7(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.post("/api/v1/orders/available-coupons",e);case 1:return r=t.v,t.a(2,(0,o.Bm)(r))}},_callee7)}))).apply(this,arguments)}},"4088":function(e,r,t){t.d(r,{"EC":function(){return listStoreAccounts},"FS":function(){return listStoreFinanceTransactions},"KA":function(){return getStore},"KW":function(){return updateStoreAccount},"Rr":function(){return listStores},"gg":function(){return deleteStoreAccount},"iR":function(){return listStoreExclusiveProducts},"jE":function(){return exportStoreFinanceTransactions},"n9":function(){return createStoreAccount}});var n=t(8646),c=t(6673),o=t(7356);function listStores(){return _listStores.apply(this,arguments)}function _listStores(){return _listStores=(0,c.A)((0,n.A)().m(function _callee(){var e,r,t=arguments;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return e=t.length>0&&void 0!==t[0]?t[0]:{},n.n=1,o.Ay.get("/api/v1/stores",{"params":e});case 1:return r=n.v,n.a(2,(0,o.Bm)(r))}},_callee)})),_listStores.apply(this,arguments)}function getStore(e){return _getStore.apply(this,arguments)}function _getStore(){return(_getStore=(0,c.A)((0,n.A)().m(function _callee2(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.get("/api/v1/stores/".concat(e));case 1:return r=t.v,t.a(2,(0,o.Bm)(r))}},_callee2)}))).apply(this,arguments)}function listStoreExclusiveProducts(e){return _listStoreExclusiveProducts.apply(this,arguments)}function _listStoreExclusiveProducts(){return _listStoreExclusiveProducts=(0,c.A)((0,n.A)().m(function _callee3(e){var r,t,c=arguments;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:{},n.n=1,o.Ay.get("/api/v1/stores/".concat(e,"/exclusive-products"),{"params":r});case 1:return t=n.v,n.a(2,(0,o.Bm)(t))}},_callee3)})),_listStoreExclusiveProducts.apply(this,arguments)}function listStoreAccounts(e){return _listStoreAccounts.apply(this,arguments)}function _listStoreAccounts(){return(_listStoreAccounts=(0,c.A)((0,n.A)().m(function _callee4(e){var r;return(0,n.A)().w(function(t){for(;;)switch(t.n){case 0:return t.n=1,o.Ay.get("/api/v1/stores/".concat(e,"/accounts"));case 1:return r=t.v,t.a(2,(0,o.Bm)(r))}},_callee4)}))).apply(this,arguments)}function createStoreAccount(e,r){return _createStoreAccount.apply(this,arguments)}function _createStoreAccount(){return(_createStoreAccount=(0,c.A)((0,n.A)().m(function _callee5(e,r){var t;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o.Ay.post("/api/v1/stores/".concat(e,"/accounts"),r);case 1:return t=n.v,n.a(2,(0,o.Bm)(t))}},_callee5)}))).apply(this,arguments)}function updateStoreAccount(e,r,t){return _updateStoreAccount.apply(this,arguments)}function _updateStoreAccount(){return(_updateStoreAccount=(0,c.A)((0,n.A)().m(function _callee6(e,r,t){var c;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o.Ay.put("/api/v1/stores/".concat(e,"/accounts/").concat(r),t);case 1:return c=n.v,n.a(2,(0,o.Bm)(c))}},_callee6)}))).apply(this,arguments)}function deleteStoreAccount(e,r){return _deleteStoreAccount.apply(this,arguments)}function _deleteStoreAccount(){return(_deleteStoreAccount=(0,c.A)((0,n.A)().m(function _callee7(e,r){var t;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,o.Ay.delete("/api/v1/stores/".concat(e,"/accounts/").concat(r));case 1:return t=n.v,n.a(2,(0,o.Bm)(t))}},_callee7)}))).apply(this,arguments)}function listStoreFinanceTransactions(e){return _listStoreFinanceTransactions.apply(this,arguments)}function _listStoreFinanceTransactions(){return _listStoreFinanceTransactions=(0,c.A)((0,n.A)().m(function _callee8(e){var r,t,c=arguments;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return r=c.length>1&&void 0!==c[1]?c[1]:{},n.n=1,o.Ay.get("/api/v1/stores/".concat(e,"/finance/transactions"),{"params":r});case 1:return t=n.v,n.a(2,(0,o.Bm)(t))}},_callee8)})),_listStoreFinanceTransactions.apply(this,arguments)}function exportStoreFinanceTransactions(e){return _exportStoreFinanceTransactions.apply(this,arguments)}function _exportStoreFinanceTransactions(){return _exportStoreFinanceTransactions=(0,c.A)((0,n.A)().m(function _callee9(e){var r,t=arguments;return(0,n.A)().w(function(n){for(;;)switch(n.n){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:{},n.n=1,o.Ay.get("/api/v1/stores/".concat(e,"/finance/transactions/export"),{"params":r,"responseType":"blob"});case 1:return n.a(2)}},_callee9)})),_exportStoreFinanceTransactions.apply(this,arguments)}}}]);