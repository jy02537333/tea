"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[413],{"6413":function(e,n,t){t.r(n),t.d(n,{"default":function(){return FeedbackPage}});var r=t(8646),a=t(6673),i=t(9866),c=t(7378),l=t(4657),s=t(9624),o=t(8785),u=t(7356);function createFeedback(e){return _createFeedback.apply(this,arguments)}function _createFeedback(){return(_createFeedback=(0,a.A)((0,r.A)().m(function _callee(e){var n,t;return(0,r.A)().w(function(r){for(;;)switch(r.p=r.n){case 0:return r.p=0,r.n=1,u.Ay.post("/api/v1/feedback",e);case 1:return n=r.v,r.a(2,(0,u.Bm)(n));case 2:return r.p=2,r.v,r.n=3,u.Ay.post("/api/v1/tickets",{"type":e.category||"suggest","source":"miniapp_feedback","title":e.subject,"content":e.content});case 3:return t=r.v,r.a(2,(0,u.Bm)(t))}},_callee,null,[[0,2]])}))).apply(this,arguments)}var d=t(6106);function FeedbackPage(){var e=["咨询","投诉","建议"],n=(0,c.useState)(0),t=(0,i.A)(n,2),u=t[0],p=t[1],h=(0,c.useState)(""),v=(0,i.A)(h,2),f=v[0],b=v[1],y=(0,c.useState)(""),g=(0,i.A)(y,2),m=g[0],S=g[1],k=(0,c.useState)(!1),x=(0,i.A)(k,2),j=x[0],A=x[1];function _handleSubmit(){return(_handleSubmit=(0,a.A)((0,r.A)().m(function _callee(){var e,n,t,a;return(0,r.A)().w(function(r){for(;;)switch(r.p=r.n){case 0:if(f.trim()&&m.trim()){r.n=1;break}return(0,s.P0)({"title":"请填写标题与内容","icon":"none"}),r.a(2);case 1:return A(!0),r.p=2,e=0===u?"consult":1===u?"complaint":"suggest",r.n=3,createFeedback({"category":e,"subject":f.trim(),"content":m.trim()});case 3:if(n=r.v,!(t=null==n?void 0:n.id)){r.n=8;break}return r.p=4,r.n=5,(0,s.to)({"title":"提交成功","content":"工单编号：#".concat(t),"showCancel":!1,"confirmText":"好的"});case 5:r.n=7;break;case 6:r.p=6,r.v;case 7:r.n=9;break;case 8:(0,s.P0)({"title":"提交成功","icon":"success"});case 9:setTimeout(function(){try{o.Ay.navigateBack({"delta":1})}catch(e){}},500),r.n=11;break;case 10:r.p=10,a=r.v,(0,s.P0)({"title":(null==a?void 0:a.message)||"提交失败","icon":"none"});case 11:return r.p=11,A(!1),r.f(11);case 12:return r.a(2)}},_callee,null,[[4,6],[2,10,11,12]])}))).apply(this,arguments)}return(0,d.jsxs)(l.Ss,{"style":{"padding":16},"children":[(0,d.jsx)(l.EY,{"style":{"fontSize":18,"fontWeight":"bold"},"children":"意见反馈"}),(0,d.jsxs)(l.Ss,{"style":{"marginTop":12},"children":[(0,d.jsx)(l.EY,{"style":{"fontSize":14,"color":"#666"},"children":"类型"}),(0,d.jsx)(l.LC,{"mode":"selector","range":e,"value":u,"onChange":function onCategoryChange(e){var n,t,r=Number(null!==(n=null==e||null===(t=e.detail)||void 0===t?void 0:t.value)&&void 0!==n?n:0);p(r)},"children":(0,d.jsx)(l.Ss,{"style":{"marginTop":6,"padding":10,"borderWidth":1,"borderStyle":"solid","borderColor":"#ddd","borderRadius":6},"children":(0,d.jsx)(l.EY,{"children":e[u]})})})]}),(0,d.jsxs)(l.Ss,{"style":{"marginTop":12},"children":[(0,d.jsx)(l.EY,{"style":{"fontSize":14,"color":"#666"},"children":"标题"}),(0,d.jsx)(l.pd,{"type":"text","placeholder":"请简要描述问题或建议","value":f,"onInput":function onInput(e){var n;return b(String((null===(n=e.detail)||void 0===n?void 0:n.value)||""))}})]}),(0,d.jsxs)(l.Ss,{"style":{"marginTop":12},"children":[(0,d.jsx)(l.EY,{"style":{"fontSize":14,"color":"#666"},"children":"内容"}),(0,d.jsx)(l.TM,{"style":{"minHeight":"120px"},"placeholder":"请详细描述问题、复现步骤或建议","value":m,"onInput":function onInput(e){var n;return S(String((null===(n=e.detail)||void 0===n?void 0:n.value)||""))}}),(0,d.jsx)(l.EY,{"style":{"display":"block","marginTop":6,"color":"#999"},"children":"为提高效率，请尽量提供相关订单号或页面截图说明（后续版本将支持图片上传）。"})]}),(0,d.jsx)(l.Ss,{"style":{"marginTop":16},"children":(0,d.jsx)(l.$n,{"type":"primary","loading":j,"disabled":j,"onClick":function handleSubmit(){return _handleSubmit.apply(this,arguments)},"children":"提交反馈"})})]})}}}]);