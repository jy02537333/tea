"use strict";(self.webpackJsonp=self.webpackJsonp||[]).push([[958],{"8958":function(t,e,n){n.r(e),n.d(e,{"default":function(){return ProductDetail}});var r=n(8646),c=n(6673),a=n(9866),o=n(7378),i=n(4657),s=n(1473),u=n(6244),l=n(9624),p=n(8785),f=n(8414),d=n(768),_=n(4088),A=n(6106);function ProductDetail(){var t=(0,o.useState)(null),e=(0,a.A)(t,2),n=e[0],m=e[1],v=(0,o.useState)(!1),h=(0,a.A)(v,2),S=h[0],y=h[1],g=(0,o.useState)(!1),w=(0,a.A)(g,2),x=w[0],C=w[1],P=(0,o.useState)(null),b=(0,a.A)(P,2),T=b[0],F=b[1];function _fetchDetail(){return(_fetchDetail=(0,c.A)((0,r.A)().m(function _callee(){var t,e,n,c,a,o,i,l,p,d;return(0,r.A)().w(function(r){for(;;)switch(r.p=r.n){case 0:if(n=(0,s.nI)().router,c=null==n||null===(t=n.params)||void 0===t?void 0:t.id,a=null==n||null===(e=n.params)||void 0===e?void 0:e.store_id,c){r.n=1;break}return r.a(2);case 1:if(o=Number(c),i=a?Number(a):void 0,y(!0),r.p=2,i&&Number.isFinite(i)&&i>0)try{(0,u.$c)("current_store_id",String(i))}catch(t){}return r.n=3,(0,f.oo)(o,i);case 3:if(l=r.v,m(l),!i){r.n=7;break}return r.p=4,r.n=5,(0,_.KA)(i);case 5:p=r.v,F(p),r.n=7;break;case 6:r.p=6,r.v;case 7:r.n=9;break;case 8:r.p=8,d=r.v,console.error("load product failed",d);case 9:return r.p=9,y(!1),r.f(9);case 10:return r.a(2)}},_callee,null,[[4,6],[2,8,9,10]])}))).apply(this,arguments)}function _handleAddToCart(){return(_handleAddToCart=(0,c.A)((0,r.A)().m(function _callee2(){var t;return(0,r.A)().w(function(e){for(;;)switch(e.p=e.n){case 0:if(n){e.n=1;break}return e.a(2);case 1:return C(!0),e.p=2,e.n=3,(0,d.bR)(n.id,null,1);case 3:(0,l.P0)({"title":"已加入购物车","icon":"success","duration":1500}),e.n=5;break;case 4:e.p=4,t=e.v,console.error("add to cart failed",t),(0,l.P0)({"title":"加入失败","icon":"none","duration":1500});case 5:return e.p=5,C(!1),e.f(5);case 6:return e.a(2)}},_callee2,null,[[2,4,5,6]])}))).apply(this,arguments)}return(0,o.useEffect)(function(){!function fetchDetail(){return _fetchDetail.apply(this,arguments)}()},[]),S?(0,A.jsx)(i.EY,{"children":"加载中..."}):n?(0,A.jsxs)(i.Ss,{"className":"page-product-detail","children":[T&&(0,A.jsx)(i.Ss,{"className":"store-badge","children":(0,A.jsxs)(i.EY,{"className":"store-text","children":["当前门店：",T.name]})}),n.images&&(0,A.jsx)(i._V,{"className":"cover","src":n.images,"mode":"aspectFill"}),(0,A.jsxs)(i.Ss,{"className":"content","children":[(0,A.jsx)(i.EY,{"className":"title","children":n.name}),(0,A.jsxs)(i.Ss,{"className":"price-row","children":[(0,A.jsxs)(i.EY,{"className":"price-now","children":["¥ ","string"==typeof n.price?n.price:Number(n.price).toFixed(2)]}),n.original_price&&(0,A.jsxs)(i.EY,{"className":"price-origin","children":["¥ ",n.original_price]})]})]}),(0,A.jsxs)(i.Ss,{"className":"action-bar","children":[(0,A.jsx)(i.$n,{"className":"btn-primary","disabled":x,"onClick":function handleAddToCart(){return _handleAddToCart.apply(this,arguments)},"children":x?"提交中...":"加入购物车"}),(0,A.jsx)(i.$n,{"className":"btn-secondary","onClick":function onClick(){return p.Ay.navigateTo({"url":"/pages/cart/index"})},"children":"去购物车"})]})]}):(0,A.jsx)(i.EY,{"children":"未找到商品"})}},"768":function(t,e,n){n.d(e,{"Fx":function(){return listCart},"SM":function(){return removeCartItem},"V2":function(){return updateCartItem},"bR":function(){return addCartItem}});var r=n(8646),c=n(6673),a=n(7356);function listCart(){return _listCart.apply(this,arguments)}function _listCart(){return(_listCart=(0,c.A)((0,r.A)().m(function _callee(){var t;return(0,r.A)().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,a.Ay.get("/api/v1/cart");case 1:return t=e.v,e.a(2,(0,a.Bm)(t))}},_callee)}))).apply(this,arguments)}function addCartItem(t,e,n){return _addCartItem.apply(this,arguments)}function _addCartItem(){return(_addCartItem=(0,c.A)((0,r.A)().m(function _callee2(t,e,n){var c;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.post("/api/v1/cart/items",{"product_id":t,"sku_id":e,"quantity":n});case 1:return c=r.v,r.a(2,(0,a.Bm)(c))}},_callee2)}))).apply(this,arguments)}function updateCartItem(t,e){return _updateCartItem.apply(this,arguments)}function _updateCartItem(){return(_updateCartItem=(0,c.A)((0,r.A)().m(function _callee3(t,e){var n;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.put("/api/v1/cart/items/".concat(t),{"quantity":e});case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee3)}))).apply(this,arguments)}function removeCartItem(t){return _removeCartItem.apply(this,arguments)}function _removeCartItem(){return(_removeCartItem=(0,c.A)((0,r.A)().m(function _callee4(t){var e;return(0,r.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,a.Ay.delete("/api/v1/cart/items/".concat(t));case 1:return e=n.v,n.a(2,(0,a.Bm)(e))}},_callee4)}))).apply(this,arguments)}},"8414":function(t,e,n){n.d(e,{"Pt":function(){return o},"d$":function(){return getProducts},"oo":function(){return getProduct}});var r=n(8646),c=n(6673),a=n(7356);function getProducts(){return _getProducts.apply(this,arguments)}function _getProducts(){return _getProducts=(0,c.A)((0,r.A)().m(function _callee(){var t,e,n=arguments;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r.n=1,a.Ay.get("/api/v1/products",{"params":t});case 1:return e=r.v,r.a(2,(0,a.Bm)(e))}},_callee)})),_getProducts.apply(this,arguments)}function getProduct(t,e){return _getProduct.apply(this,arguments)}function _getProduct(){return(_getProduct=(0,c.A)((0,r.A)().m(function _callee2(t,e){var n;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.get("/api/v1/products/".concat(t),{"params":e?{"store_id":e}:{}});case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee2)}))).apply(this,arguments)}var o=getProducts},"4088":function(t,e,n){n.d(e,{"EC":function(){return listStoreAccounts},"FS":function(){return listStoreFinanceTransactions},"KA":function(){return getStore},"KW":function(){return updateStoreAccount},"Rr":function(){return listStores},"gg":function(){return deleteStoreAccount},"iR":function(){return listStoreExclusiveProducts},"jE":function(){return exportStoreFinanceTransactions},"n9":function(){return createStoreAccount}});var r=n(8646),c=n(6673),a=n(7356);function listStores(){return _listStores.apply(this,arguments)}function _listStores(){return _listStores=(0,c.A)((0,r.A)().m(function _callee(){var t,e,n=arguments;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:{},r.n=1,a.Ay.get("/api/v1/stores",{"params":t});case 1:return e=r.v,r.a(2,(0,a.Bm)(e))}},_callee)})),_listStores.apply(this,arguments)}function getStore(t){return _getStore.apply(this,arguments)}function _getStore(){return(_getStore=(0,c.A)((0,r.A)().m(function _callee2(t){var e;return(0,r.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,a.Ay.get("/api/v1/stores/".concat(t));case 1:return e=n.v,n.a(2,(0,a.Bm)(e))}},_callee2)}))).apply(this,arguments)}function listStoreExclusiveProducts(t){return _listStoreExclusiveProducts.apply(this,arguments)}function _listStoreExclusiveProducts(){return _listStoreExclusiveProducts=(0,c.A)((0,r.A)().m(function _callee3(t){var e,n,c=arguments;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return e=c.length>1&&void 0!==c[1]?c[1]:{},r.n=1,a.Ay.get("/api/v1/stores/".concat(t,"/exclusive-products"),{"params":e});case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee3)})),_listStoreExclusiveProducts.apply(this,arguments)}function listStoreAccounts(t){return _listStoreAccounts.apply(this,arguments)}function _listStoreAccounts(){return(_listStoreAccounts=(0,c.A)((0,r.A)().m(function _callee4(t){var e;return(0,r.A)().w(function(n){for(;;)switch(n.n){case 0:return n.n=1,a.Ay.get("/api/v1/stores/".concat(t,"/accounts"));case 1:return e=n.v,n.a(2,(0,a.Bm)(e))}},_callee4)}))).apply(this,arguments)}function createStoreAccount(t,e){return _createStoreAccount.apply(this,arguments)}function _createStoreAccount(){return(_createStoreAccount=(0,c.A)((0,r.A)().m(function _callee5(t,e){var n;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.post("/api/v1/stores/".concat(t,"/accounts"),e);case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee5)}))).apply(this,arguments)}function updateStoreAccount(t,e,n){return _updateStoreAccount.apply(this,arguments)}function _updateStoreAccount(){return(_updateStoreAccount=(0,c.A)((0,r.A)().m(function _callee6(t,e,n){var c;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.put("/api/v1/stores/".concat(t,"/accounts/").concat(e),n);case 1:return c=r.v,r.a(2,(0,a.Bm)(c))}},_callee6)}))).apply(this,arguments)}function deleteStoreAccount(t,e){return _deleteStoreAccount.apply(this,arguments)}function _deleteStoreAccount(){return(_deleteStoreAccount=(0,c.A)((0,r.A)().m(function _callee7(t,e){var n;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return r.n=1,a.Ay.delete("/api/v1/stores/".concat(t,"/accounts/").concat(e));case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee7)}))).apply(this,arguments)}function listStoreFinanceTransactions(t){return _listStoreFinanceTransactions.apply(this,arguments)}function _listStoreFinanceTransactions(){return _listStoreFinanceTransactions=(0,c.A)((0,r.A)().m(function _callee8(t){var e,n,c=arguments;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return e=c.length>1&&void 0!==c[1]?c[1]:{},r.n=1,a.Ay.get("/api/v1/stores/".concat(t,"/finance/transactions"),{"params":e});case 1:return n=r.v,r.a(2,(0,a.Bm)(n))}},_callee8)})),_listStoreFinanceTransactions.apply(this,arguments)}function exportStoreFinanceTransactions(t){return _exportStoreFinanceTransactions.apply(this,arguments)}function _exportStoreFinanceTransactions(){return _exportStoreFinanceTransactions=(0,c.A)((0,r.A)().m(function _callee9(t){var e,n=arguments;return(0,r.A)().w(function(r){for(;;)switch(r.n){case 0:return e=n.length>1&&void 0!==n[1]?n[1]:{},r.n=1,a.Ay.get("/api/v1/stores/".concat(t,"/finance/transactions/export"),{"params":e,"responseType":"blob"});case 1:return r.a(2)}},_callee9)})),_exportStoreFinanceTransactions.apply(this,arguments)}}}]);