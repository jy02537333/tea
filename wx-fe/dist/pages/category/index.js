"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[545],{7174:function(e,r,n){var i=n(7586),t=n(8646),o=n(4302),s=n(6673),a=n(9986),l=n(7378),d=n(427),c=n(7168),u=n.n(c),v=n(8773);function p(){return f.apply(this,arguments)}function f(){return f=(0,s.A)((0,t.A)().m(function e(){var r,n,i=arguments;return(0,t.A)().w(function(e){while(1)switch(e.n){case 0:return r=i.length>0&&void 0!==i[0]?i[0]:{},e.n=1,v.Ay.get("/api/v1/categories",{params:r});case 1:return n=e.v,e.a(2,(0,v.Bm)(n))}},e)})),f.apply(this,arguments)}var h=n(5665),y=n(6787),m=n(6106),A=10;function g(){var e=(0,l.useState)([]),r=(0,a.A)(e,2),n=r[0],i=r[1],c=(0,l.useState)(void 0),v=(0,a.A)(c,2),f=v[0],g=v[1],x=(0,l.useState)([]),w=(0,a.A)(x,2),S=w[0],b=w[1],j=(0,l.useState)(0),k=(0,a.A)(j,2),E=k[0],C=k[1],Y=(0,l.useState)(void 0),T=(0,a.A)(Y,2),_=T[0],B=T[1],R=(0,l.useState)(""),z=(0,a.A)(R,2),W=z[0],$=z[1],D=(0,l.useState)([]),J=(0,a.A)(D,2),M=J[0],O=J[1],P=(0,l.useState)(1),I=(0,a.A)(P,2),L=I[0],N=I[1],U=(0,l.useState)(!0),X=(0,a.A)(U,2),q=X[0],F=X[1],G=(0,l.useState)(!1),H=(0,a.A)(G,2),K=H[0],Q=H[1],V=(0,l.useState)(!0),Z=(0,a.A)(V,2),ee=Z[0],re=Z[1];function ne(){return ie.apply(this,arguments)}function ie(){return ie=(0,s.A)((0,t.A)().m(function e(){return(0,t.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return re(!0),e.p=1,e.n=2,Promise.all([te(),se()]);case 2:return e.n=3,le({reset:!0});case 3:return e.p=3,re(!1),e.f(3);case 4:return e.a(2)}},e,null,[[1,,3,4]])})),ie.apply(this,arguments)}function te(){return oe.apply(this,arguments)}function oe(){return oe=(0,s.A)((0,t.A)().m(function e(){var r,n,o;return(0,t.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,p({status:1});case 1:r=e.v,n=Array.isArray(null===r||void 0===r?void 0:r.data)?r.data:Array.isArray(null===r||void 0===r?void 0:r.items)?r.items:Array.isArray(r)?r:[],i(n),e.n=3;break;case 2:e.p=2,o=e.v,console.error("load categories failed",o),u().showToast({title:"\u52a0\u8f7d\u5206\u7c7b\u5931\u8d25",icon:"none"});case 3:return e.a(2)}},e,null,[[0,2]])})),oe.apply(this,arguments)}function se(){return ae.apply(this,arguments)}function ae(){return ae=(0,s.A)((0,t.A)().m(function e(){var r,n,i;return(0,t.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,y.Rr)({page:1,limit:50});case 1:r=e.v,n=Array.isArray(null===r||void 0===r?void 0:r.data)?r.data:Array.isArray(null===r||void 0===r?void 0:r.items)?r.items:Array.isArray(r)?r:[],b(n),e.n=3;break;case 2:e.p=2,i=e.v,console.error("load stores failed",i),u().showToast({title:"\u52a0\u8f7d\u95e8\u5e97\u5931\u8d25",icon:"none"});case 3:return e.a(2)}},e,null,[[0,2]])})),ae.apply(this,arguments)}function le(){return de.apply(this,arguments)}function de(){return de=(0,s.A)((0,t.A)().m(function e(){var r,n,i,s,a,l,d,c,v,p,y,m,g,x=arguments;return(0,t.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(r=x.length>0&&void 0!==x[0]?x[0]:{},!K){e.n=1;break}return e.a(2);case 1:return n=r.reset,i=void 0!==n&&n,s=r.overrides,a=i?1:L+1,l=void 0!==(null===s||void 0===s?void 0:s.category_id)?s.category_id:f,d=void 0!==(null===s||void 0===s?void 0:s.store_id)?s.store_id:_,c=void 0!==(null===s||void 0===s?void 0:s.keyword)?s.keyword:W,Q(!0),e.p=2,e.n=3,(0,h.d$)({page:a,limit:A,category_id:l,keyword:c?c.trim():void 0,store_id:d});case 3:v=e.v,p=Array.isArray(null===v||void 0===v?void 0:v.data)?v.data:Array.isArray(null===v||void 0===v?void 0:v.items)?v.items:Array.isArray(v)?v:[],O(function(e){return i?p:[].concat((0,o.A)(e),(0,o.A)(p))}),N(a),y="number"===typeof(null===v||void 0===v?void 0:v.total)?v.total:void 0,m="number"===typeof(null===v||void 0===v?void 0:v.limit)?v.limit:A,F(void 0!==y?a*m<y:p.length===m),e.n=5;break;case 4:e.p=4,g=e.v,console.error("load products failed",g),u().showToast({title:"\u52a0\u8f7d\u5546\u54c1\u5931\u8d25",icon:"none"});case 5:return e.p=5,Q(!1),e.f(5);case 6:return e.a(2)}},e,null,[[2,4,5,6]])})),de.apply(this,arguments)}function ce(e){g(e),le({reset:!0,overrides:{category_id:e}})}function ue(e){var r,n,i,t=Number(null!==(r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.value)&&void 0!==r?r:0);C(t);var o=0===t||null===(i=S[t-1])||void 0===i?void 0:i.id;B(o),le({reset:!0,overrides:{store_id:o}})}function ve(e){var r,n,i=(null!==(r=null===e||void 0===e||null===(n=e.detail)||void 0===n?void 0:n.value)&&void 0!==r?r:W).trim();$(i),le({reset:!0,overrides:{keyword:i}})}function pe(){q&&!K&&le()}(0,l.useEffect)(function(){ne()},[]);var fe=(0,l.useMemo)(function(){return["\u5168\u90e8\u95e8\u5e97"].concat((0,o.A)(S.map(function(e){return e.name})))},[S]);return(0,m.jsxs)(d.Ss,{style:{padding:12},children:[(0,m.jsx)(d.Ss,{style:{marginBottom:12},children:(0,m.jsx)(d.pd,{type:"text",placeholder:"\u641c\u7d22\u5546\u54c1\u5173\u952e\u5b57",value:W,onInput:function(e){return $(e.detail.value)},onConfirm:ve})}),(0,m.jsxs)(d.Ss,{style:{marginBottom:16},children:[(0,m.jsx)(d.EY,{style:{fontSize:14,color:"#666"},children:"\u9009\u62e9\u95e8\u5e97"}),(0,m.jsx)(d.LC,{mode:"selector",range:fe,onChange:ue,value:E,children:(0,m.jsx)(d.Ss,{style:{marginTop:8,padding:12,borderWidth:1,borderStyle:"solid",borderColor:"#ddd",borderRadius:6},children:(0,m.jsx)(d.EY,{children:fe[E]||"\u5168\u90e8\u95e8\u5e97"})})})]}),(0,m.jsxs)(d.Ss,{style:{marginBottom:12},children:[(0,m.jsx)(d.EY,{style:{fontSize:14,color:"#666"},children:"\u5546\u54c1\u5206\u7c7b"}),(0,m.jsx)(d.BM,{scrollX:!0,style:{whiteSpace:"nowrap",marginTop:8},showScrollbar:!1,children:(0,m.jsxs)(d.Ss,{style:{display:"flex",flexDirection:"row"},children:[(0,m.jsx)(d.Ss,{style:{padding:"8px 16px",marginRight:8,borderRadius:16,backgroundColor:void 0===f?"#07c160":"#f0f0f0"},onClick:function(){return ce(void 0)},children:(0,m.jsx)(d.EY,{style:{color:void 0===f?"#fff":"#333"},children:"\u5168\u90e8"})}),n.map(function(e){var r=e.id===f;return(0,m.jsx)(d.Ss,{style:{padding:"8px 16px",marginRight:8,borderRadius:16,backgroundColor:r?"#07c160":"#f0f0f0"},onClick:function(){return ce(e.id)},children:(0,m.jsx)(d.EY,{style:{color:r?"#fff":"#333"},children:e.name})},e.id)})]})})]}),(0,m.jsxs)(d.Ss,{children:[ee&&(0,m.jsx)(d.EY,{children:"\u52a0\u8f7d\u4e2d..."}),!ee&&0===M.length&&(0,m.jsx)(d.EY,{children:"\u6682\u65e0\u5546\u54c1"}),M.map(function(e){return(0,m.jsxs)(d.Ss,{style:{padding:12,borderBottomWidth:1,borderStyle:"solid",borderColor:"#f2f2f2"},children:[(0,m.jsx)(d.EY,{style:{fontSize:16,fontWeight:"bold"},children:e.name}),(0,m.jsxs)(d.EY,{style:{display:"block",marginTop:4},children:["\u73b0\u4ef7\uff1a\xa5",e.price]}),e.original_price&&(0,m.jsxs)(d.EY,{style:{display:"block",marginTop:2,color:"#999",textDecoration:"line-through"},children:["\u539f\u4ef7\uff1a\xa5",e.original_price]}),(0,m.jsx)(d.$n,{size:"mini",style:{marginTop:8,width:120},onClick:function(){return u().navigateTo({url:"/pages/product-detail/index?id=".concat(e.id)})},children:"\u67e5\u770b\u8be6\u60c5"})]},e.id)})]}),(0,m.jsx)(d.Ss,{style:{marginTop:16,textAlign:"center"},children:q?(0,m.jsx)(d.$n,{size:"mini",loading:K,onClick:pe,children:K?"\u52a0\u8f7d\u4e2d...":"\u52a0\u8f7d\u66f4\u591a"}):(0,m.jsx)(d.EY,{style:{color:"#999"},children:"\u5df2\u52a0\u8f7d\u5168\u90e8\u5546\u54c1"})})]})}var x={},w=(0,i.eU)(g,"pages/category/index",{root:{cn:[]}},x||{});g&&g.behaviors&&(w.behaviors=(w.behaviors||[]).concat(g.behaviors));Page(w)}},function(e){var r=function(r){return e(e.s=r)};e.O(0,[907,96,76],function(){return r(7174)});e.O()}]);