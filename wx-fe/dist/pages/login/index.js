"use strict";(wx["webpackJsonp"]=wx["webpackJsonp"]||[]).push([[734],{2958:function(n,e,t){var o=t(7586),i=t(8646),r=t(6673),s=t(9986),a=t(7378),c=t(427),l=t(7168),u=t.n(l),d=t(4227),p=t(8773),f=t(6106);function h(){var n=(0,a.useState)(""),e=(0,s.A)(n,2),t=e[0],o=e[1],l=(0,a.useState)(!1),h=(0,s.A)(l,2),g=h[0],b=h[1],x=(0,a.useState)(null),v=(0,s.A)(x,2),y=v[0],m=v[1],w=(0,a.useState)(!1),k=(0,s.A)(w,2),j=k[0],T=k[1];function E(){return A.apply(this,arguments)}function A(){return A=(0,r.A)((0,i.A)().m(function n(){var e;return(0,i.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return T(!0),n.p=1,n.n=2,(0,d.ug)();case 2:e=n.v,m(e),n.n=4;break;case 3:n.p=3,n.v,m(null);case 4:return n.p=4,T(!1),n.f(4);case 5:return n.a(2)}},n,null,[[1,3,4,5]])})),A.apply(this,arguments)}function S(){return C.apply(this,arguments)}function C(){return C=(0,r.A)((0,i.A)().m(function n(){var e,t;return(0,i.A)().w(function(n){while(1)switch(n.p=n.n){case 0:return b(!0),n.p=1,n.n=2,u().login();case 2:if(e=n.v,e.code){n.n=3;break}throw new Error("\u672a\u83b7\u53d6\u5230\u5fae\u4fe1 code");case 3:return n.n=4,(0,d.iD)({code:e.code});case 4:return n.n=5,E();case 5:u().showToast({title:"\u767b\u5f55\u6210\u529f",icon:"success",duration:1200}),setTimeout(function(){u().switchTab({url:"/pages/index/index"}).catch(function(){u().redirectTo({url:"/pages/index/index"})})},500),n.n=7;break;case 6:n.p=6,t=n.v,u().showToast({title:(null===t||void 0===t?void 0:t.message)||"\u767b\u5f55\u5931\u8d25",icon:"none",duration:1500});case 7:return n.p=7,b(!1),n.f(7);case 8:return n.a(2)}},n,null,[[1,6,7,8]])})),C.apply(this,arguments)}function Y(){return D.apply(this,arguments)}function D(){return D=(0,r.A)((0,i.A)().m(function n(){var e;return(0,i.A)().w(function(n){while(1)switch(n.p=n.n){case 0:if(t){n.n=1;break}return u().showToast({title:"\u8bf7\u8f93\u5165 openid",icon:"none"}),n.a(2);case 1:return b(!0),n.p=2,n.n=3,(0,d.iD)({openid:t});case 3:return n.n=4,E();case 4:u().showToast({title:"Dev \u767b\u5f55\u6210\u529f",icon:"success",duration:1200}),n.n=6;break;case 5:n.p=5,e=n.v,u().showToast({title:(null===e||void 0===e?void 0:e.message)||"Dev \u767b\u5f55\u5931\u8d25",icon:"none"});case 6:return n.p=6,b(!1),n.f(6);case 7:return n.a(2)}},n,null,[[2,5,6,7]])})),D.apply(this,arguments)}function R(){(0,p.WG)(null),m(null),u().showToast({title:"\u5df2\u9000\u51fa",icon:"none"})}return(0,a.useEffect)(function(){E()},[]),(0,f.jsxs)(c.Ss,{style:{minHeight:"100vh",padding:24,backgroundColor:"#f5f6f8"},children:[(0,f.jsxs)(c.Ss,{style:{marginBottom:24,textAlign:"center"},children:[(0,f.jsx)(c._V,{src:(null===y||void 0===y?void 0:y.avatar)||"https://dummyimage.com/120x120/EEEEEE/333333&text=Tea",style:{width:120,height:120,borderRadius:60,margin:"0 auto 12px"}}),(0,f.jsx)(c.EY,{style:{fontSize:20,fontWeight:"bold"},children:y?y.nickname||"\u5fae\u4fe1\u7528\u6237":"\u8bf7\u767b\u5f55"}),(null===y||void 0===y?void 0:y.phone)&&(0,f.jsx)(c.EY,{style:{display:"block",marginTop:6,color:"#666"},children:y.phone})]}),(0,f.jsxs)(c.Ss,{style:{backgroundColor:"#fff",borderRadius:12,padding:20,marginBottom:20},children:[(0,f.jsx)(c.EY,{style:{fontSize:16,fontWeight:"bold"},children:"\u5fae\u4fe1\u4e00\u952e\u767b\u5f55"}),(0,f.jsx)(c.EY,{style:{display:"block",marginTop:6,color:"#666"},children:"\u6388\u6743\u540e\u5373\u53ef\u540c\u6b65\u8ba2\u5355\u3001\u4f18\u60e0\u5238\u7b49\u6570\u636e"}),(0,f.jsx)(c.$n,{style:{marginTop:16,backgroundColor:"#07c160",color:"#fff"},loading:g,onClick:S,children:"\u4f7f\u7528\u5fae\u4fe1\u6388\u6743\u767b\u5f55"})]}),(0,f.jsxs)(c.Ss,{style:{backgroundColor:"#fff",borderRadius:12,padding:20,marginBottom:20},children:[(0,f.jsx)(c.EY,{style:{fontSize:16,fontWeight:"bold"},children:"\u5f00\u53d1\u8005 OpenID \u767b\u5f55"}),(0,f.jsx)(c.pd,{type:"text",placeholder:"admin_openid",value:t,onInput:function(n){return o(n.detail.value)},style:{marginTop:12,backgroundColor:"#f7f7f7",borderRadius:6,padding:8}}),(0,f.jsx)(c.$n,{style:{marginTop:12},loading:g,onClick:Y,children:"\u4f7f\u7528 OpenID \u767b\u5f55"})]}),y&&(0,f.jsxs)(c.Ss,{style:{backgroundColor:"#fff",borderRadius:12,padding:20},children:[(0,f.jsx)(c.EY,{style:{fontSize:16,fontWeight:"bold"},children:"\u5df2\u767b\u5f55"}),(0,f.jsxs)(c.EY,{style:{display:"block",marginTop:8},children:["\u7528\u6237ID\uff1a",y.id]}),(0,f.jsx)(c.$n,{style:{marginTop:16},onClick:R,children:"\u9000\u51fa\u767b\u5f55"})]}),!y&&!j&&(0,f.jsx)(c.EY,{style:{display:"block",textAlign:"center",marginTop:12,color:"#888"},children:"\u767b\u5f55\u540e\u53ef\u7ee7\u7eed\u8bbf\u95ee\u5546\u57ce"})]})}var g={},b=(0,o.eU)(h,"pages/login/index",{root:{cn:[]}},g||{});h&&h.behaviors&&(b.behaviors=(b.behaviors||[]).concat(h.behaviors));Page(b)}},function(n){var e=function(e){return n(n.s=e)};n.O(0,[907,96,76],function(){return e(2958)});n.O()}]);